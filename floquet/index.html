
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the floquet software library">
      
      
        <meta name="author" content="Daniel Weiss">
      
      
        <link rel="canonical" href="http://dkweiss.net/floquet/floquet/">
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../FAQ/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Python API - floquet</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../_static/custom_css.css">
    
      <link rel="stylesheet" href="../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../css/pandas-dataframe.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#python-api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="floquet" class="md-header__button md-logo" aria-label="floquet" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            floquet
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Python API
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/dkweiss31/floquet" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    dkweiss31/floquet
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="floquet" class="md-nav__button md-logo" aria-label="floquet" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    floquet
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/dkweiss31/floquet" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    dkweiss31/floquet
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Python API
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Python API
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#floquet-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Floquet methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Floquet methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#floquet.floquet" class="md-nav__link">
    <span class="md-ellipsis">
      floquet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#floquet.floquet.FloquetAnalysis" class="md-nav__link">
    <span class="md-ellipsis">
      FloquetAnalysis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#displaced-state" class="md-nav__link">
    <span class="md-ellipsis">
      Displaced state
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Displaced state">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#floquet.displaced_state" class="md-nav__link">
    <span class="md-ellipsis">
      displaced_state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#floquet.displaced_state.DisplacedState" class="md-nav__link">
    <span class="md-ellipsis">
      DisplacedState
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#floquet.displaced_state.DisplacedStateFit" class="md-nav__link">
    <span class="md-ellipsis">
      DisplacedStateFit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model" class="md-nav__link">
    <span class="md-ellipsis">
      Model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#floquet.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#floquet.model.Model" class="md-nav__link">
    <span class="md-ellipsis">
      Model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amplitude-conversion-utilities" class="md-nav__link">
    <span class="md-ellipsis">
      Amplitude conversion utilities
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Amplitude conversion utilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#floquet.amplitude_converters" class="md-nav__link">
    <span class="md-ellipsis">
      amplitude_converters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#floquet.amplitude_converters.ChiacToAmp" class="md-nav__link">
    <span class="md-ellipsis">
      ChiacToAmp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#floquet.amplitude_converters.XiSqToAmp" class="md-nav__link">
    <span class="md-ellipsis">
      XiSqToAmp
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#options" class="md-nav__link">
    <span class="md-ellipsis">
      Options
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#floquet.options" class="md-nav__link">
    <span class="md-ellipsis">
      options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#floquet.options.Options" class="md-nav__link">
    <span class="md-ellipsis">
      Options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-utilities" class="md-nav__link">
    <span class="md-ellipsis">
      File utilities
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File utilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#floquet.utils.file_io" class="md-nav__link">
    <span class="md-ellipsis">
      file_io
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#floquet.utils.file_io.Serializable" class="md-nav__link">
    <span class="md-ellipsis">
      Serializable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#floquet.utils.file_io.read_from_file" class="md-nav__link">
    <span class="md-ellipsis">
      read_from_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#floquet.utils.file_io.get_init_params" class="md-nav__link">
    <span class="md-ellipsis">
      get_init_params
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#floquet.utils.file_io.generate_file_path" class="md-nav__link">
    <span class="md-ellipsis">
      generate_file_path
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            FAQ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../FAQ/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/transmon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transmon
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/EJ_sweep/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Qubit parameter sweep
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/parametric/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parametric driving
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/fluxonium/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fluxonium
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="python-api">Python API<a class="headerlink" href="#python-api" title="Permanent link">¤</a></h1>
<p>The <strong>floquet</strong> Python API consists largely of the <strong>floquet_analysis</strong> function which initializes a <strong>FloquetAnalysis</strong> class. We can then call <code>run(filepath)</code> on instances of this class to perform the Floquet simulation. The computed data is then saved both as attributes of the class and also to the file specified by <code>filepath</code>, which should be a string specifying a <code>h5py</code> file.</p>
<h2 id="floquet-methods">Floquet methods<a class="headerlink" href="#floquet-methods" title="Permanent link">¤</a></h2>


<div class="doc doc-object doc-module">



<a id="floquet.floquet"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="floquet.floquet.FloquetAnalysis" class="doc doc-heading">
            <code>FloquetAnalysis</code>


<a href="#floquet.floquet.FloquetAnalysis" class="headerlink" title="Permanent link">¤</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Serializable (floquet.utils.file_io.Serializable)" href="#floquet.utils.file_io.Serializable">Serializable</a></code></p>


        <p>Perform a floquet analysis to identify nonlinear resonances.</p>
<p>In most workflows, one needs only to call the run() method which performs
both the displaced state fit and the Blais branch analysis. For an example
workflow, see the <a href="../examples/transmon">transmon</a> tutorial.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (floquet.model.Model)" href="#floquet.model.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Class specifying the model, including the Hamiltonian, drive amplitudes,
frequencies</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>state_indices</code>
            </td>
            <td>
                  <code><span title="list">list</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>State indices of interest. Defaults to [0, 1], indicating the two
lowest-energy states.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>options</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Options (floquet.options.Options)" href="#floquet.options.Options">Options</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Options for the Floquet analysis.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Options (floquet.options.Options)" href="#floquet.options.Options">Options</a>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>init_data_to_save</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial parameter metadata to save to file. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>










  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="floquet.floquet.FloquetAnalysis.model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">model</span> <span class="o">=</span> <span class="n">model</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.floquet.FloquetAnalysis.model" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.floquet.FloquetAnalysis.state_indices" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">state_indices</span> <span class="o">=</span> <span class="n">state_indices</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.floquet.FloquetAnalysis.state_indices" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.floquet.FloquetAnalysis.options" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">options</span> <span class="o">=</span> <span class="n">options</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.floquet.FloquetAnalysis.options" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.floquet.FloquetAnalysis.init_data_to_save" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">init_data_to_save</span> <span class="o">=</span> <span class="n">init_data_to_save</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.floquet.FloquetAnalysis.init_data_to_save" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.floquet.FloquetAnalysis.hilbert_dim" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hilbert_dim</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">H0</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.floquet.FloquetAnalysis.hilbert_dim" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h5 id="floquet.floquet.FloquetAnalysis.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span> <span class="n">state_indices</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="n">Options</span> <span class="o">=</span> <span class="n">Options</span><span class="p">(),</span> <span class="n">init_data_to_save</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span></code>

<a href="#floquet.floquet.FloquetAnalysis.__init__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.floquet.FloquetAnalysis.__str__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

<a href="#floquet.floquet.FloquetAnalysis.__str__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.floquet.FloquetAnalysis.run_one_floquet" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_one_floquet</span><span class="p">(</span><span class="n">omega_d_amp</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">qt</span><span class="o">.</span><span class="n">Qobj</span><span class="p">]</span></code>

<a href="#floquet.floquet.FloquetAnalysis.run_one_floquet" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Run one instance of the problem for a pair of drive frequency and amp.</p>
<p>Returns floquet modes as numpy column vectors, as well as the quasienergies.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>omega_d_amp</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pair of drive frequency and amp.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.floquet.FloquetAnalysis.identify_floquet_modes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">identify_floquet_modes</span><span class="p">(</span><span class="n">f_modes_energies</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">qt</span><span class="o">.</span><span class="n">Qobj</span><span class="p">],</span> <span class="n">params_0</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">displaced_state</span><span class="p">:</span> <span class="n">DisplacedState</span><span class="p">,</span> <span class="n">previous_coefficients</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>

<a href="#floquet.floquet.FloquetAnalysis.identify_floquet_modes" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Return floquet modes with largest overlap with ideal displaced state.</p>
<p>Also return that overlap value.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>f_modes_energies</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="numpy.ndarray">ndarray</span>, <span title="qutip.Qobj">Qobj</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>output of self.run_one_floquet(params)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>params_0</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(omega_d_0, amp_0) to use for displaced fit</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>displaced_state</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DisplacedState (floquet.displaced_state.DisplacedState)" href="#floquet.displaced_state.DisplacedState">DisplacedState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Instance of DisplacedState</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>previous_coefficients</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coefficients from the previous amplitude range that
will be used when calculating overlap of the floquet modes against
the 'bare' states specified by previous_coefficients</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.floquet.FloquetAnalysis.bare_state_array" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bare_state_array</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>

<a href="#floquet.floquet.FloquetAnalysis.bare_state_array" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Return array of bare states.</p>
<p>Used to specify initial bare states for the Blais branch analysis.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.floquet.FloquetAnalysis.run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span></code>

<a href="#floquet.floquet.FloquetAnalysis.run" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Perform floquet analysis over range of amplitudes and drive frequencies.</p>
<p>This function largely performs two calculations. The first is the Xiao analysis
introduced in https://arxiv.org/abs/2304.13656, fitting the extracted Floquet
modes to the "ideal" displaced state which does not include resonances by design
(because we fit to a low order polynomial and ignore any floquet modes with
overlap with the bare state below a given threshold). This analysis produces the
"scar" plots. The second is the Blais branch analysis, which tracks the Floquet
modes by stepping in drive amplitude for a given drive frequency. For this
reason the code is structured to parallelize over drive frequency, but scans in
a loop over drive amplitude. This way the two calculations can be performed
simultaneously.</p>
<p>A nice bonus is that both of the above mentioned calculations determine
essentially independently whether a resonance occurs. In the first, it is
deviation of the Floquet mode from the fitted displaced state. In the second,
it is branch swapping that indicates a resonance, independent of any fit. Thus
the two simulations can be used for cross validation of one another.</p>
<p>We perform these simulations iteratively over the drive amplitudes as specified
by fit_range_fraction. This is to allow for simulations stretching to large
drive amplitudes, where the overlap with the bare eigenstate would fall below
the threshold (due to ac Stark shift) even in the absence of any resonances.
We thus use the fit from the previous range of drive amplitudes as our new bare
state.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.floquet.FloquetAnalysis.__new__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__new__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Serializable</span></code>

<a href="#floquet.floquet.FloquetAnalysis.__new__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Records which parameters should be saved so they can be passed to init.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.floquet.FloquetAnalysis.__eq__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">Serializable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

<a href="#floquet.floquet.FloquetAnalysis.__eq__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.floquet.FloquetAnalysis.__hash__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__hash__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span></code>

<a href="#floquet.floquet.FloquetAnalysis.__hash__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.floquet.FloquetAnalysis.serialize" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">serialize</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span></code>

<a href="#floquet.floquet.FloquetAnalysis.serialize" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Serialize a class so that it is ready to be written.</p>
<p>This method creates nested dictionaries appropriate for writing to h5 files.
Importantly, we save metadata associated with the class itself and any classes
it takes as input so that they can be reinstantiated later.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>initdata</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of data to save, in a format appropriate to pass to h5</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.floquet.FloquetAnalysis.write_to_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_to_file</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span></code>

<a href="#floquet.floquet.FloquetAnalysis.write_to_file" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Write a class and associated data to file.</p>
<p>The goal is to be able to read back both the data that was saved and all of the
data necessary to reinitialize the class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the file where we want to save the data. Must be an h5 or
h5py file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing various raw data to save</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="displaced-state">Displaced state<a class="headerlink" href="#displaced-state" title="Permanent link">¤</a></h2>


<div class="doc doc-object doc-module">



<a id="floquet.displaced_state"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="floquet.displaced_state.DisplacedState" class="doc doc-heading">
            <code>DisplacedState</code>


<a href="#floquet.displaced_state.DisplacedState" class="headerlink" title="Permanent link">¤</a></h4>


    <div class="doc doc-contents ">


        <p>Class providing methods for computing displaced states.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>hilbert_dim</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hilbert space dimension</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (floquet.model.Model)" href="#floquet.model.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Model including the Hamiltonian, drive amplitudes, frequencies,
state indices</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>state_indices</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>States of interest</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>options</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Options (floquet.options.Options)" href="#floquet.options.Options">Options</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Options used</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>










  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="floquet.displaced_state.DisplacedState.hilbert_dim" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hilbert_dim</span> <span class="o">=</span> <span class="n">hilbert_dim</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.displaced_state.DisplacedState.hilbert_dim" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.displaced_state.DisplacedState.model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">model</span> <span class="o">=</span> <span class="n">model</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.displaced_state.DisplacedState.model" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.displaced_state.DisplacedState.state_indices" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">state_indices</span> <span class="o">=</span> <span class="n">state_indices</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.displaced_state.DisplacedState.state_indices" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.displaced_state.DisplacedState.options" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">options</span> <span class="o">=</span> <span class="n">options</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.displaced_state.DisplacedState.options" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.displaced_state.DisplacedState.exponent_pair_idx_map" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">exponent_pair_idx_map</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_exponent_pair_idx_map</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.displaced_state.DisplacedState.exponent_pair_idx_map" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h5 id="floquet.displaced_state.DisplacedState.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">hilbert_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span> <span class="n">state_indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="n">Options</span><span class="p">)</span></code>

<a href="#floquet.displaced_state.DisplacedState.__init__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.displaced_state.DisplacedState.overlap_with_bare_states" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">overlap_with_bare_states</span><span class="p">(</span><span class="n">amp_idx_0</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">floquet_modes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>

<a href="#floquet.displaced_state.DisplacedState.overlap_with_bare_states" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Calculate overlap of floquet modes with 'bare' states.</p>
<p>'Bare' here is defined loosely. For the first range of amplitudes, the bare
states are truly the bare states (the coefficients are obtained from
bare_state_coefficients, which give the bare states). For later ranges, we
define the bare state as the state obtained from the fit from previous range,
with amplitude evaluated at the lower edge of amplitudes for the new region.
This is, in a sense, the most natural choice, since it is most analogous to what
is done in the first window when the overlap is computed against bare
eigenstates (that obviously don't have amplitude dependence). Moreover, the fit
coefficients for the previous window by definition were obtained in a window
that does not include the one we are currently investigating. Asking for the
state with amplitude values outside of the fit window should be done at your
own peril.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>amp_idx_0</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index specifying the lower bound of the amplitude range.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>coefficients</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>coefficients that specify the bare state that we calculate
overlaps of Floquet modes against</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>floquet_modes</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Floquet modes to be compared to the bare states given by
coefficients</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns:
    overlaps with shape (w,a,s) where w is the number of drive frequencies,
        a is the number of drive amplitudes (specified by amp_idxs) and s is the
        number of states we are investigating</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.displaced_state.DisplacedState.overlap_with_displaced_states" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">overlap_with_displaced_states</span><span class="p">(</span><span class="n">amp_idxs</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">floquet_modes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>

<a href="#floquet.displaced_state.DisplacedState.overlap_with_displaced_states" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Calculate overlap of floquet modes with 'ideal' displaced states.</p>
<p>This is done here for a specific amplitude range.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>amp_idxs</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of lower and upper amplitude indices specifying the range of
drive amplitudes this calculation should be done for</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>coefficients</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>coefficients that specify the displaced state that we
calculate overlaps of Floquet modes against</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>floquet_modes</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Floquet modes to be compared to the displaced states given by
coefficients</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns:
    overlaps with shape (w,a,s) where w is the number of drive frequencies,
        a is the number of drive amplitudes (specified by amp_idxs) and s is the
        number of states we are investigating</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.displaced_state.DisplacedState.bare_state_coefficients" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bare_state_coefficients</span><span class="p">(</span><span class="n">state_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>

<a href="#floquet.displaced_state.DisplacedState.bare_state_coefficients" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>For bare state only component is itself.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state_idx</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coefficients for the state <span class="arithmatex">\(|state_idx\rangle\)</span> that when
evaluated at any amplitude or frequency simply return the bare state.
Note that this should be the actual state index, and not the array index
(for instance if we have state_indices=[0, 1, 3] because we're not
interested in the second excited state, for the 3rd excited state we
should pass 3 here and not 2).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.displaced_state.DisplacedState.displaced_state" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">displaced_state</span><span class="p">(</span><span class="n">omega_d</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">amp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">state_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">qt</span><span class="o">.</span><span class="n">Qobj</span></code>

<a href="#floquet.displaced_state.DisplacedState.displaced_state" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Construct the ideal displaced state based on a polynomial expansion.</p>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="floquet.displaced_state.DisplacedStateFit" class="doc doc-heading">
            <code>DisplacedStateFit</code>


<a href="#floquet.displaced_state.DisplacedStateFit" class="headerlink" title="Permanent link">¤</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="DisplacedState (floquet.displaced_state.DisplacedState)" href="#floquet.displaced_state.DisplacedState">DisplacedState</a></code></p>


        <p>Methods for fitting an ideal displaced state to calculated Floquet modes.</p>










  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="floquet.displaced_state.DisplacedStateFit.hilbert_dim" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hilbert_dim</span> <span class="o">=</span> <span class="n">hilbert_dim</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.displaced_state.DisplacedStateFit.hilbert_dim" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.displaced_state.DisplacedStateFit.model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">model</span> <span class="o">=</span> <span class="n">model</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.displaced_state.DisplacedStateFit.model" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.displaced_state.DisplacedStateFit.state_indices" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">state_indices</span> <span class="o">=</span> <span class="n">state_indices</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.displaced_state.DisplacedStateFit.state_indices" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.displaced_state.DisplacedStateFit.options" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">options</span> <span class="o">=</span> <span class="n">options</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.displaced_state.DisplacedStateFit.options" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.displaced_state.DisplacedStateFit.exponent_pair_idx_map" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">exponent_pair_idx_map</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_exponent_pair_idx_map</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.displaced_state.DisplacedStateFit.exponent_pair_idx_map" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h5 id="floquet.displaced_state.DisplacedStateFit.displaced_states_fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">displaced_states_fit</span><span class="p">(</span><span class="n">omega_d_amp_slice</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">ovlp_with_bare_states</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">floquet_modes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>

<a href="#floquet.displaced_state.DisplacedStateFit.displaced_states_fit" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Perform a fit for the indicated range, ignoring specified modes.</p>
<p>We loop over all states in state_indices and perform the fit for a given
amplitude range. We ignore floquet modes (not included in the fit) where
the corresponding value in ovlp_with_bare_states is below the threshold
specified in options.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>omega_d_amp_slice</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pairs of omega_d, amplitude values at which the
floquet modes have been computed and which we will use as the
independent variables to fit the Floquet modes</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ovlp_with_bare_states</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Bare state overlaps that has shape (w, a, s) where w
is drive frequency, a is drive amplitude and s is state_indices</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>floquet_modes</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Floquet mode array with the same shape as
ovlp_with_bare_states except with an additional trailing dimension h,
the Hilbert-space dimension.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optimized fit coefficients</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.displaced_state.DisplacedStateFit.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">hilbert_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span> <span class="n">state_indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="n">Options</span><span class="p">)</span></code>

<a href="#floquet.displaced_state.DisplacedStateFit.__init__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.displaced_state.DisplacedStateFit.overlap_with_bare_states" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">overlap_with_bare_states</span><span class="p">(</span><span class="n">amp_idx_0</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">floquet_modes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>

<a href="#floquet.displaced_state.DisplacedStateFit.overlap_with_bare_states" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Calculate overlap of floquet modes with 'bare' states.</p>
<p>'Bare' here is defined loosely. For the first range of amplitudes, the bare
states are truly the bare states (the coefficients are obtained from
bare_state_coefficients, which give the bare states). For later ranges, we
define the bare state as the state obtained from the fit from previous range,
with amplitude evaluated at the lower edge of amplitudes for the new region.
This is, in a sense, the most natural choice, since it is most analogous to what
is done in the first window when the overlap is computed against bare
eigenstates (that obviously don't have amplitude dependence). Moreover, the fit
coefficients for the previous window by definition were obtained in a window
that does not include the one we are currently investigating. Asking for the
state with amplitude values outside of the fit window should be done at your
own peril.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>amp_idx_0</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index specifying the lower bound of the amplitude range.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>coefficients</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>coefficients that specify the bare state that we calculate
overlaps of Floquet modes against</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>floquet_modes</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Floquet modes to be compared to the bare states given by
coefficients</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns:
    overlaps with shape (w,a,s) where w is the number of drive frequencies,
        a is the number of drive amplitudes (specified by amp_idxs) and s is the
        number of states we are investigating</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.displaced_state.DisplacedStateFit.overlap_with_displaced_states" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">overlap_with_displaced_states</span><span class="p">(</span><span class="n">amp_idxs</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">floquet_modes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>

<a href="#floquet.displaced_state.DisplacedStateFit.overlap_with_displaced_states" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Calculate overlap of floquet modes with 'ideal' displaced states.</p>
<p>This is done here for a specific amplitude range.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>amp_idxs</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of lower and upper amplitude indices specifying the range of
drive amplitudes this calculation should be done for</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>coefficients</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>coefficients that specify the displaced state that we
calculate overlaps of Floquet modes against</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>floquet_modes</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Floquet modes to be compared to the displaced states given by
coefficients</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns:
    overlaps with shape (w,a,s) where w is the number of drive frequencies,
        a is the number of drive amplitudes (specified by amp_idxs) and s is the
        number of states we are investigating</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.displaced_state.DisplacedStateFit.bare_state_coefficients" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bare_state_coefficients</span><span class="p">(</span><span class="n">state_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>

<a href="#floquet.displaced_state.DisplacedStateFit.bare_state_coefficients" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>For bare state only component is itself.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state_idx</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coefficients for the state <span class="arithmatex">\(|state_idx\rangle\)</span> that when
evaluated at any amplitude or frequency simply return the bare state.
Note that this should be the actual state index, and not the array index
(for instance if we have state_indices=[0, 1, 3] because we're not
interested in the second excited state, for the 3rd excited state we
should pass 3 here and not 2).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.displaced_state.DisplacedStateFit.displaced_state" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">displaced_state</span><span class="p">(</span><span class="n">omega_d</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">amp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">state_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">qt</span><span class="o">.</span><span class="n">Qobj</span></code>

<a href="#floquet.displaced_state.DisplacedStateFit.displaced_state" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Construct the ideal displaced state based on a polynomial expansion.</p>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="model">Model<a class="headerlink" href="#model" title="Permanent link">¤</a></h2>


<div class="doc doc-object doc-module">



<a id="floquet.model"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="floquet.model.Model" class="doc doc-heading">
            <code>Model</code>


<a href="#floquet.model.Model" class="headerlink" title="Permanent link">¤</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Serializable (floquet.utils.file_io.Serializable)" href="#floquet.utils.file_io.Serializable">Serializable</a></code></p>


        <p>Specify the model, including the Hamiltonian, drive strengths and frequencies.</p>
<p>Can be subclassed to e.g. override the hamiltonian() method for a different (but
still periodic!) Hamiltonian.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>H0</code>
            </td>
            <td>
                  <code><span title="qutip.Qobj">Qobj</span> | <span title="numpy.ndarray">ndarray</span> | <span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Drift Hamiltonian, which must be diagonal and provided in units such that
H0 can be passed directly to qutip.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>H1</code>
            </td>
            <td>
                  <code><span title="qutip.Qobj">Qobj</span> | <span title="numpy.ndarray">ndarray</span> | <span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Drive operator, which should be unitless (for instance the charge-number
operator n of the transmon). It will be multiplied by a drive amplitude
that we scan over from drive_parameters.drive_amplitudes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>omega_d_values</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>drive frequencies to scan over</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drive_amplitudes</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>amp values to scan over. Can be one dimensional in which case
these amplitudes are used for all omega_d, or it can be two dimensional
in which case the first dimension are the amplitudes to scan over
and the second are the amplitudes for respective drive frequencies</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>










  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="floquet.model.Model.H0" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">H0</span> <span class="o">=</span> <span class="n">H0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.model.Model.H0" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.model.Model.H1" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">H1</span> <span class="o">=</span> <span class="n">H1</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.model.Model.H1" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.model.Model.omega_d_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">omega_d_values</span> <span class="o">=</span> <span class="n">omega_d_values</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.model.Model.omega_d_values" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.model.Model.drive_amplitudes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">drive_amplitudes</span> <span class="o">=</span> <span class="n">drive_amplitudes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.model.Model.drive_amplitudes" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h5 id="floquet.model.Model.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">H0</span><span class="p">:</span> <span class="n">qt</span><span class="o">.</span><span class="n">Qobj</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span> <span class="n">H1</span><span class="p">:</span> <span class="n">qt</span><span class="o">.</span><span class="n">Qobj</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span> <span class="n">omega_d_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">drive_amplitudes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span></code>

<a href="#floquet.model.Model.__init__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.model.Model.omega_d_to_idx" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">omega_d_to_idx</span><span class="p">(</span><span class="n">omega_d</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span></code>

<a href="#floquet.model.Model.omega_d_to_idx" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Return index corresponding to omega_d value.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.model.Model.amp_to_idx" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">amp_to_idx</span><span class="p">(</span><span class="n">amp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">omega_d</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span></code>

<a href="#floquet.model.Model.amp_to_idx" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Return index corresponding to amplitude value.</p>
<p>Because the drive amplitude can depend on the drive frequency, we also must pass
the drive frequency here.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.model.Model.omega_d_amp_params" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">omega_d_amp_params</span><span class="p">(</span><span class="n">amp_idxs</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span></code>

<a href="#floquet.model.Model.omega_d_amp_params" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Return ordered chain object of the specified omega_d and amplitude values.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.model.Model.hamiltonian" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hamiltonian</span><span class="p">(</span><span class="n">omega_d_amp</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">qt</span><span class="o">.</span><span class="n">Qobj</span><span class="p">]</span></code>

<a href="#floquet.model.Model.hamiltonian" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Return the Hamiltonian we actually simulate.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.model.Model.__new__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__new__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Serializable</span></code>

<a href="#floquet.model.Model.__new__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Records which parameters should be saved so they can be passed to init.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.model.Model.__eq__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">Serializable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

<a href="#floquet.model.Model.__eq__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.model.Model.__hash__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__hash__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span></code>

<a href="#floquet.model.Model.__hash__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.model.Model.__str__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

<a href="#floquet.model.Model.__str__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.model.Model.serialize" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">serialize</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span></code>

<a href="#floquet.model.Model.serialize" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Serialize a class so that it is ready to be written.</p>
<p>This method creates nested dictionaries appropriate for writing to h5 files.
Importantly, we save metadata associated with the class itself and any classes
it takes as input so that they can be reinstantiated later.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>initdata</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of data to save, in a format appropriate to pass to h5</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.model.Model.write_to_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_to_file</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span></code>

<a href="#floquet.model.Model.write_to_file" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Write a class and associated data to file.</p>
<p>The goal is to be able to read back both the data that was saved and all of the
data necessary to reinitialize the class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the file where we want to save the data. Must be an h5 or
h5py file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing various raw data to save</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="amplitude-conversion-utilities">Amplitude conversion utilities<a class="headerlink" href="#amplitude-conversion-utilities" title="Permanent link">¤</a></h2>


<div class="doc doc-object doc-module">



<a id="floquet.amplitude_converters"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="floquet.amplitude_converters.ChiacToAmp" class="doc doc-heading">
            <code>ChiacToAmp</code>


<a href="#floquet.amplitude_converters.ChiacToAmp" class="headerlink" title="Permanent link">¤</a></h4>


    <div class="doc doc-contents ">


        <p>Convert given induced ac-stark shift values to drive amplitudes.</p>
<p>Consider a qubit coupled to an oscillator with the interaction Hamiltonian
<span class="arithmatex">\(H_I = g(a + a^{\dagger})(b + b^{\dagger})\)</span>. If the oscillator is driven to
an average occupation number of <span class="arithmatex">\(\bar{n}\)</span>, then the effective drive strength
seen by the qubit is <span class="arithmatex">\(\Omega_d = 2 g \sqrt{\bar{n}}\)</span>. On the other hand based
on a Schrieffer-Wolff transformation, the interaction hamiltonian is
<span class="arithmatex">\(H^{(2)} = \chi a^{\dagger}ab^{\dagger}b\)</span>. The average induced
ac-stark shift is then <span class="arithmatex">\(\chi_{ac} = \chi \bar{n}\)</span>. Thus <span class="arithmatex">\(\Omega_d = 2g\sqrt{\chi_{\rm ac}/\chi}\)</span>.
Observe that since <span class="arithmatex">\(\chi \sim g^2\)</span>, <span class="arithmatex">\(g\)</span> effectively cancels out and can be set to 1.</p>










  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="floquet.amplitude_converters.ChiacToAmp.H0" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">H0</span> <span class="o">=</span> <span class="n">H0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.amplitude_converters.ChiacToAmp.H0" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.amplitude_converters.ChiacToAmp.H1" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">H1</span> <span class="o">=</span> <span class="n">H1</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.amplitude_converters.ChiacToAmp.H1" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.amplitude_converters.ChiacToAmp.state_indices" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">state_indices</span> <span class="o">=</span> <span class="n">state_indices</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.amplitude_converters.ChiacToAmp.state_indices" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.amplitude_converters.ChiacToAmp.omega_d_linspace" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">omega_d_linspace</span> <span class="o">=</span> <span class="n">omega_d_values</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.amplitude_converters.ChiacToAmp.omega_d_linspace" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h5 id="floquet.amplitude_converters.ChiacToAmp.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">H0</span><span class="p">:</span> <span class="n">qt</span><span class="o">.</span><span class="n">Qobj</span><span class="p">,</span> <span class="n">H1</span><span class="p">:</span> <span class="n">qt</span><span class="o">.</span><span class="n">Qobj</span><span class="p">,</span> <span class="n">state_indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">omega_d_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span></code>

<a href="#floquet.amplitude_converters.ChiacToAmp.__init__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.amplitude_converters.ChiacToAmp.amplitudes_for_omega_d" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">amplitudes_for_omega_d</span><span class="p">(</span><span class="n">chi_ac_linspace</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>

<a href="#floquet.amplitude_converters.ChiacToAmp.amplitudes_for_omega_d" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Return drive amplitudes corresponding to <span class="arithmatex">\(\chi_{\rm ac}\)</span> values.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.amplitude_converters.ChiacToAmp.compute_chis_for_omega_d" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_chis_for_omega_d</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>

<a href="#floquet.amplitude_converters.ChiacToAmp.compute_chis_for_omega_d" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Compute chi difference for the first two states in state_indices.</p>
<p>Based on the analysis in Zhu et al PRB (2013)</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.amplitude_converters.ChiacToAmp.chi_ell_ellp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">chi_ell_ellp</span><span class="p">(</span><span class="n">energies</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">H1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">E_osc</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ell</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ellp</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#floquet.amplitude_converters.ChiacToAmp.chi_ell_ellp" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.amplitude_converters.ChiacToAmp.chi_ell" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">chi_ell</span><span class="p">(</span><span class="n">energies</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">H1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">E_osc</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ell</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>

<a href="#floquet.amplitude_converters.ChiacToAmp.chi_ell" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="floquet.amplitude_converters.XiSqToAmp" class="doc doc-heading">
            <code>XiSqToAmp</code>


<a href="#floquet.amplitude_converters.XiSqToAmp" class="headerlink" title="Permanent link">¤</a></h4>


    <div class="doc doc-contents ">


        <p>Convert given <span class="arithmatex">\(|\xi|^2\)</span> value into a drive amplitude.</p>
<p>This is based on the equivalence <span class="arithmatex">\(\xi = 2 \Omega_d \omega_d / (\omega_d^2-\omega^2)\)</span>,
where in this definition <span class="arithmatex">\(|\xi|^2= 2 \chi_{\rm ac} / \alpha\)</span> where <span class="arithmatex">\(\chi_{\rm ac}\)</span> is
the induced ac stark shift, <span class="arithmatex">\(\alpha\)</span> is the anharmonicity and <span class="arithmatex">\(\Omega_d\)</span> is the
drive amplitude.</p>










  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="floquet.amplitude_converters.XiSqToAmp.H0" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">H0</span> <span class="o">=</span> <span class="n">H0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.amplitude_converters.XiSqToAmp.H0" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.amplitude_converters.XiSqToAmp.H1" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">H1</span> <span class="o">=</span> <span class="n">H1</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.amplitude_converters.XiSqToAmp.H1" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.amplitude_converters.XiSqToAmp.state_indices" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">state_indices</span> <span class="o">=</span> <span class="n">state_indices</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.amplitude_converters.XiSqToAmp.state_indices" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.amplitude_converters.XiSqToAmp.omega_d_linspace" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">omega_d_linspace</span> <span class="o">=</span> <span class="n">omega_d_linspace</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.amplitude_converters.XiSqToAmp.omega_d_linspace" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h5 id="floquet.amplitude_converters.XiSqToAmp.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">H0</span><span class="p">:</span> <span class="n">qt</span><span class="o">.</span><span class="n">Qobj</span><span class="p">,</span> <span class="n">H1</span><span class="p">:</span> <span class="n">qt</span><span class="o">.</span><span class="n">Qobj</span><span class="p">,</span> <span class="n">state_indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">omega_d_linspace</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span></code>

<a href="#floquet.amplitude_converters.XiSqToAmp.__init__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.amplitude_converters.XiSqToAmp.amplitudes_for_omega_d" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">amplitudes_for_omega_d</span><span class="p">(</span><span class="n">xi_sq_linspace</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>

<a href="#floquet.amplitude_converters.XiSqToAmp.amplitudes_for_omega_d" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Return drive amplitudes corresponding to <span class="arithmatex">\(|\xi|^2\)</span> values.</p>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="options">Options<a class="headerlink" href="#options" title="Permanent link">¤</a></h2>


<div class="doc doc-object doc-module">



<a id="floquet.options"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="floquet.options.Options" class="doc doc-heading">
            <code>Options</code>


<a href="#floquet.options.Options" class="headerlink" title="Permanent link">¤</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Serializable (floquet.utils.file_io.Serializable)" href="#floquet.utils.file_io.Serializable">Serializable</a></code></p>


        <p>Options for the floquet analysis.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fit_range_fraction</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fraction of the amplitude range to sweep over before
changing the definition of the bare state to that of the fitted state from
the previous range. For instance if fit_range_fraction=0.4, then the
amplitude range is split up into three chunks: the first 40% of the
amplitude linspace, then from 40% -&gt; 80%, then from 80% to the full range.
For the first fraction of amplitudes, they are compared to the bare
eigenstates for identification. For the second range, they are compared to
the fitted state from the first range. And so on. Defaults to 1.0,
indicating that no iteration is performed.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>floquet_sampling_time_fraction</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>What point of the drive period we want to sample
the Floquet modes. Defaults to 0.0, indicating the floquet modes at t=0*T
where T is the drive period.</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fit_cutoff</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Cutoff for the fit polynomial of the displaced state. Defaults to 4.</p>
              </div>
            </td>
            <td>
                  <code>4</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overlap_cutoff</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Cutoff for fitting overlaps. Floquet modes with overlap with the
"bare" state below this cutoff are not included in the fit (as they may be
experiencing a resonance). Defaults to 0.8.</p>
              </div>
            </td>
            <td>
                  <code>0.8</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nsteps</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>QuTiP integration parameter, number of steps the solver can take.
Defaults to 30_000.</p>
              </div>
            </td>
            <td>
                  <code>30000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_cpus</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of cpus to use in parallel computation of Floquet modes over
the different values of omega_d, amp. Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_floquet_modes</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indicating whether to save the extracted Floquet modes
themselves. Such data is often unnecessary and requires a fair amount of
storage, so the default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>










  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="floquet.options.Options.fit_range_fraction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit_range_fraction</span> <span class="o">=</span> <span class="n">fit_range_fraction</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.options.Options.fit_range_fraction" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.options.Options.floquet_sampling_time_fraction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">floquet_sampling_time_fraction</span> <span class="o">=</span> <span class="n">floquet_sampling_time_fraction</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.options.Options.floquet_sampling_time_fraction" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.options.Options.fit_cutoff" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit_cutoff</span> <span class="o">=</span> <span class="n">fit_cutoff</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.options.Options.fit_cutoff" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.options.Options.overlap_cutoff" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">overlap_cutoff</span> <span class="o">=</span> <span class="n">overlap_cutoff</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.options.Options.overlap_cutoff" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.options.Options.nsteps" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nsteps</span> <span class="o">=</span> <span class="n">nsteps</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.options.Options.nsteps" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.options.Options.num_cpus" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_cpus</span> <span class="o">=</span> <span class="n">num_cpus</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.options.Options.num_cpus" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="floquet.options.Options.save_floquet_modes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_floquet_modes</span> <span class="o">=</span> <span class="n">save_floquet_modes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#floquet.options.Options.save_floquet_modes" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h5 id="floquet.options.Options.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">fit_range_fraction</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">floquet_sampling_time_fraction</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">fit_cutoff</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">overlap_cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">nsteps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30000</span><span class="p">,</span> <span class="n">num_cpus</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">save_floquet_modes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span></code>

<a href="#floquet.options.Options.__init__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.options.Options.__new__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__new__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Serializable</span></code>

<a href="#floquet.options.Options.__new__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Records which parameters should be saved so they can be passed to init.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.options.Options.__eq__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">Serializable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

<a href="#floquet.options.Options.__eq__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.options.Options.__hash__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__hash__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span></code>

<a href="#floquet.options.Options.__hash__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.options.Options.__str__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

<a href="#floquet.options.Options.__str__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.options.Options.serialize" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">serialize</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span></code>

<a href="#floquet.options.Options.serialize" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Serialize a class so that it is ready to be written.</p>
<p>This method creates nested dictionaries appropriate for writing to h5 files.
Importantly, we save metadata associated with the class itself and any classes
it takes as input so that they can be reinstantiated later.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>initdata</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of data to save, in a format appropriate to pass to h5</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.options.Options.write_to_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_to_file</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span></code>

<a href="#floquet.options.Options.write_to_file" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Write a class and associated data to file.</p>
<p>The goal is to be able to read back both the data that was saved and all of the
data necessary to reinitialize the class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the file where we want to save the data. Must be an h5 or
h5py file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing various raw data to save</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="file-utilities">File utilities<a class="headerlink" href="#file-utilities" title="Permanent link">¤</a></h2>


<div class="doc doc-object doc-module">



<a id="floquet.utils.file_io"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="floquet.utils.file_io.Serializable" class="doc doc-heading">
            <code>Serializable</code>


<a href="#floquet.utils.file_io.Serializable" class="headerlink" title="Permanent link">¤</a></h4>


    <div class="doc doc-contents ">


        <p>Mixin class for reading and writing to file using h5py.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="floquet.utils.file_io.Serializable.__new__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__new__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Serializable</span></code>

<a href="#floquet.utils.file_io.Serializable.__new__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Records which parameters should be saved so they can be passed to init.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.utils.file_io.Serializable.__eq__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">Serializable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

<a href="#floquet.utils.file_io.Serializable.__eq__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.utils.file_io.Serializable.__hash__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__hash__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span></code>

<a href="#floquet.utils.file_io.Serializable.__hash__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.utils.file_io.Serializable.__str__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

<a href="#floquet.utils.file_io.Serializable.__str__" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.utils.file_io.Serializable.serialize" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">serialize</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span></code>

<a href="#floquet.utils.file_io.Serializable.serialize" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Serialize a class so that it is ready to be written.</p>
<p>This method creates nested dictionaries appropriate for writing to h5 files.
Importantly, we save metadata associated with the class itself and any classes
it takes as input so that they can be reinstantiated later.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>initdata</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of data to save, in a format appropriate to pass to h5</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="floquet.utils.file_io.Serializable.write_to_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_to_file</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span></code>

<a href="#floquet.utils.file_io.Serializable.write_to_file" class="headerlink" title="Permanent link">¤</a></h5>


    <div class="doc doc-contents ">

        <p>Write a class and associated data to file.</p>
<p>The goal is to be able to read back both the data that was saved and all of the
data necessary to reinitialize the class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the file where we want to save the data. Must be an h5 or
h5py file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing various raw data to save</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="floquet.utils.file_io.read_from_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_from_file</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Serializable</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]</span></code>

<a href="#floquet.utils.file_io.read_from_file" class="headerlink" title="Permanent link">¤</a></h4>


    <div class="doc doc-contents ">

        <p>Read a class and associated data from file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the file containing both raw data and the information needed
to reinitialize our class</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>new_class_instance</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="Serializable (floquet.utils.file_io.Serializable)" href="#floquet.utils.file_io.Serializable">Serializable</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Class that inherits from Serializable that was earlier
written with its method write_to_file</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>data_dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of data that was passed to write_to_file at the time</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="floquet.utils.file_io.get_init_params" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_init_params</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Serializable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

<a href="#floquet.utils.file_io.get_init_params" class="headerlink" title="Permanent link">¤</a></h4>


    <div class="doc doc-contents ">

        <p>Returns a list of parameters entering <code>__init__</code> of <code>obj</code>.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="floquet.utils.file_io.generate_file_path" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_file_path</span><span class="p">(</span><span class="n">extension</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

<a href="#floquet.utils.file_io.generate_file_path" class="headerlink" title="Permanent link">¤</a></h4>


    <div class="doc doc-contents ">


    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "toc.integrate"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>